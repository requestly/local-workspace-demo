{
  "name": "Add person (from CSV)",
  "request": {
    "type": "http",
    "url": "{{baseUrl}}/persons",
    "scripts": {
      "preRequest": "(function () {\n  const name = rq.iterationData.get(\"name\");\n  const email = rq.iterationData.get(\"email\");\n\n  console.log(\"Running iteration for:\", { name, email });\n\n  rq.test(\"Iteration data is present\", () => {\n    rq.expect(name).to.exist;\n    rq.expect(email).to.exist;\n  });\n})();\n",
      "postResponse": "(function () {\n  const res = rq.response.json();\n  const expectedName = rq.iterationData.get(\"name\");\n\n  rq.test(\"Person created successfully\", () => {\n    rq.expect(res.success).to.eql(true);\n  });\n\n  rq.test(\"Response matches CSV input\", () => {\n    rq.expect(res.data.name).to.eql(expectedName);\n  });\n\n  // Save for cleanup\n  rq.environment.set(\"LAST_PERSON_ID\", res.data.id);\n\n  console.log(\"Created person ID:\", res.data.id);\n})();\n"
    },
    "method": "POST",
    "queryParams": [],
    "headers": [
      {
        "id": 1770161968600,
        "key": "Content-Type",
        "value": "application/json",
        "isEnabled": true,
        "description": "",
        "dataType": "string"
      },
      {
        "id": 1770161979669,
        "key": "Accept",
        "value": "application/json",
        "isEnabled": true,
        "description": "",
        "dataType": "string"
      }
    ],
    "body": "{\n  \"name\": \"{{name}}\",\n  \"emails\": [\n    {\n      \"value\": \"{{email}}\",\n      \"primary\": true,\n      \"label\": \"work\"\n    }\n  ],\n  \"phones\": [\n    {\n      \"value\": \"{{phone}}\",\n      \"primary\": true,\n      \"label\": \"mobile\"\n    }\n  ],\n  \"visible_to\": {{visible_to}}\n}\n",
    "contentType": "text/plain",
    "auth": {
      "currentAuthType": "INHERIT",
      "authConfigStore": {}
    },
    "pathVariables": []
  }
}